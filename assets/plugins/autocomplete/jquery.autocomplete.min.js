!function(t){t.fn.autocomplete=function(e){return this.each(function(){this.timer=null,this.items=new Array,t.extend(this,e),t(this).attr("autocomplete","off"),t(this).on("focus",function(){this.request()}),t(this).on("blur",function(){setTimeout(function(i){i.hide()},200,this)}),t(this).on("keydown",function(i){switch(i.keyCode){case 27:this.hide();break;default:this.request()}}),this.click=function(i){i.preventDefault(),value=t(i.target).parent().attr("data-value"),value&&this.items[value]&&this.select(this.items[value])},this.show=function(){var i=t(this).position();t(this).siblings("ul.dropdown-menu").css({top:i.top+t(this).outerHeight(),left:i.left}),t(this).siblings("ul.dropdown-menu").show()},this.hide=function(){t(this).siblings("ul.dropdown-menu").hide()},this.request=function(){clearTimeout(this.timer),this.timer=setTimeout(function(i){i.source(t(i).val(),t.proxy(i.response,i))},200,this)},this.response=function(e){if(html="",e.length){for(i=0;i<e.length;i++)this.items[e[i].value]=e[i];for(i=0;i<e.length;i++)e[i].category||(html+='<li data-value="'+e[i].value+'"><a href="#">'+e[i].label+"</a></li>");var s=new Array;for(i=0;i<e.length;i++)e[i].category&&(s[e[i].category]||(s[e[i].category]=new Array,s[e[i].category].name=e[i].category,s[e[i].category].item=new Array),s[e[i].category].item.push(e[i]));for(i in s)for(html+='<li class="dropdown-header">'+s[i].name+"</li>",j=0;j<s[i].item.length;j++)html+='<li data-value="'+s[i].item[j].value+'"><a href="#">&nbsp;&nbsp;&nbsp;'+s[i].item[j].label+"</a></li>"}html?this.show():this.hide(),t(this).siblings("ul.dropdown-menu").html(html)},t(this).after('<ul class="dropdown-menu"></ul>'),t(this).siblings("ul.dropdown-menu").delegate("a","click",t.proxy(this.click,this))})}}(window.jQuery);